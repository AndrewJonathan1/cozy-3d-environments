<!DOCTYPE html>
<html>
<head>
    <title>Official CSS3D Test</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; }
        .status {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="status">
        <p>Testing official CSS3DRenderer...</p>
        <p>You typed: <span id="count">(nothing yet)</span></p>
    </div>
    
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.155.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.155.0/examples/jsm/"
        }
    }
    </script>
    
    <script type="module">
        import * as THREE from 'three';
        import { CSS3DRenderer, CSS3DObject } from 'three/addons/renderers/CSS3DRenderer.js';
        
        let count = 0;
        function increment() {
            count++;
            document.getElementById('count').textContent = count;
        }
        window.increment = increment;
        
        // Scene setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 500;
        
        // WebGL renderer
        const webglRenderer = new THREE.WebGLRenderer({ alpha: true });
        webglRenderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(webglRenderer.domElement);
        
        // CSS3D renderer
        const css3dRenderer = new CSS3DRenderer();
        css3dRenderer.setSize(window.innerWidth, window.innerHeight);
        css3dRenderer.domElement.style.position = 'absolute';
        css3dRenderer.domElement.style.top = '0';
        css3dRenderer.domElement.style.pointerEvents = 'none';
        document.body.appendChild(css3dRenderer.domElement);
        
        // Green cube (WebGL)
        const geometry = new THREE.BoxGeometry(100, 100, 100);
        const material = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: true });
        const cube = new THREE.Mesh(geometry, material);
        scene.add(cube);
        
        // HTML text input (CSS3D)
        const inputElement = document.createElement('input');
        inputElement.type = 'text';
        inputElement.placeholder = 'Type here...';
        inputElement.style.background = 'white';
        inputElement.style.color = 'black';
        inputElement.style.border = '2px solid red';
        inputElement.style.padding = '20px 40px';
        inputElement.style.fontSize = '20px';
        inputElement.style.textAlign = 'center';
        inputElement.style.pointerEvents = 'auto';
        inputElement.oninput = function() {
            document.getElementById('count').textContent = this.value || '(empty)';
        };
        
        const css3dObject = new CSS3DObject(inputElement);
        css3dObject.position.set(200, 0, 0);
        scene.add(css3dObject);
        
        console.log('Button created:', css3dObject);
        
        // Mouse controls
        let mouseX = 0, mouseY = 0;
        document.addEventListener('mousemove', (event) => {
            mouseX = (event.clientX - window.innerWidth / 2) / 200;
            mouseY = (event.clientY - window.innerHeight / 2) / 200;
        });
        
        function animate() {
            requestAnimationFrame(animate);
            
            camera.position.x = Math.sin(mouseX) * 300;
            camera.position.y = Math.sin(mouseY) * 150;
            camera.lookAt(scene.position);
            
            webglRenderer.render(scene, camera);
            css3dRenderer.render(scene, camera);
        }
        
        animate();
    </script>
</body>
</html>